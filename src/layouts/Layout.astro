---
import '../styles/global.css';
import Comments from '../components/Comments.astro';
const { frontmatter } = Astro.props;
const title = frontmatter?.title || Astro.props.title || "Jeff Patton | Cloud Architect";
const isBlogPost = Astro.url.pathname.startsWith('/blog');
---
<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<title>{title}</title>
		
		<script is:inline>
			const theme = (() => {
				if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
					return localStorage.getItem('theme');
				}
				return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
			})();
			document.documentElement.classList.toggle('dark', theme === 'dark');
		</script>

		<script is:inline>
			(function(n,i,v,r,s,c,x,z){x=window.AwsRumClient={q:[],n:n,i:i,v:v,r:r,c:c};window[n]=function(c,p){x.q.push({c:c,p:p});};z=document.createElement('script');z.async=true;z.src=s;document.head.insertBefore(z,document.head.getElementsByTagName('script')[0]);})(
				'cwr',
				'ceedfa36-a442-4a90-af3f-5038bc82c84e',
				'1.0.0',
				'us-east-1',
				'https://client.rum.us-east-1.amazonaws.com/1.19.0/cwr.js',
				{
					sessionSampleRate: 1,
					identityPoolId: "us-east-1:5158c3c8-d592-4bc0-810b-7f15eb0376a8",
					endpoint: "https://dataplane.rum.us-east-1.amazonaws.com",
					telemetries: ["performance","errors","http"],
					allowCookies: true,
					enableXRay: false,
					signing: true
				}
			);
		</script>
	</head>
	<body class="bg-white text-slate-900 dark:bg-black dark:text-slate-100 transition-colors duration-300 antialiased">
		<main class="max-w-4xl mx-auto px-6 py-12">
			<nav class="flex justify-between items-center mb-12 border-b border-slate-200 dark:border-slate-800 pb-6">
				<a href="/" class="font-bold text-xl">Patton Tech Blog</a>
				<button id="themeToggle" class="p-2 rounded-lg border border-slate-200 dark:border-slate-800">
					<span class="dark:hidden">üåô</span><span class="hidden dark:inline">‚òÄÔ∏è</span>
				</button>
			</nav>
			
			<article class="prose prose-slate prose-lg dark:prose-invert max-w-none">
				<slot />
			</article>

			{isBlogPost && <Comments />}
		</main>

		<script>
			document.getElementById('themeToggle').addEventListener('click', () => {
				const isDark = document.documentElement.classList.toggle('dark');
				localStorage.setItem('theme', isDark ? 'dark' : 'light');
			});
		</script>
	</body>
</html>
